---
title: "BAE 204 - Lab11_Homework #7"
author: "Fran√ßois Birgand"
date: "due 3 April 2020 before midnight"
output:
  html_document: default
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.height=5, fig.width=9, fig.align="center", echo = FALSE)
```

# Exercise 1

Below, the hydrograph for the year 2008-2009 for the Cuyahoga River at Independence, OH is plotted. 

```{r , echo=FALSE, eval=TRUE}

data<-read.csv(file="Lin_1h_cuyahoga_all_2008-2009_SI_ref.csv",header = TRUE) #Reads file into table format

WSarea<-707*1.60934^2 #Area of watershed in km2
WS<-"Flow Rate at Cuyahoga River at Independence, OH"
#  names(data)=c("datetime","Q","C")   # renames the columns in simpler names
  data<-as.data.frame(data)
  data$datetime<-as.POSIXct(strptime(data$datetime, "%Y-%m-%d %H:%M:%S")) # transforms characters into date values understood by R
  D<-data$datetime
  Q<-data$Q   #Defines Q as the flow value (m3/s)
  
  N=nrow(data)   #Sets N to the value equal to the number of total rows in the table
  
  # definition of the x and y axes limits
  
  startdate<-D[1]
  enddate<-D[N]
  xlim = as.POSIXct(c(startdate,enddate))  # this renders the first and last date understandable for plotting purposes
  ylimQ = c(0,max(Q))           # ylim for flow
      
  ScaleF = 1.2                  # scaling factor for size of fonts and other things
      
  y1lab<-expression("Flow rate (" * m^3 * "/s)")  # defines the label for flow
  
  par(mar=c(4.5,4.5,4,4.5))     # defines the sizes, in number of lines, for the margins (bottom, left, top, right)
  
      ltyp=c(1,2)
      
      plot(D,Q,col="blue",type="l",cex=0.1,yaxt="n",     
           lty=ltyp[1],xaxt="n",xlab="",ylab="",xlim=xlim,ylim=ylimQ)
      # we are taking all the default addition of axis tick marks and numbers out by using xaxt and yaxt = "n"
      # and setting the axis labels at nothing using xlab = "" and ylab = ""
      abline(h=0)
      abline(v=seq(startdate, enddate, by="week"),col=("grey"))
      axis.POSIXct(1, at=seq(startdate, enddate, by="month"), format="%m/%d",cex.axis=ScaleF)
      # this tells R that we want the X axis ticks and values to be displayed as dates, be added on a monthly basis,
      # using the month/day format
      axis(2,cex.axis=ScaleF)
      # this tells R that the first Y axis ticks can be displayed  (that function was repressed earlier by 'yaxt="n" ')
      par(new=TRUE)
      # this tells R that a new plot has already been opened, in other words you are telling R to keep adding things
      # on the existing plot
      
      mtext("Dates in 1997-1998",side=1,line=3,cex=ScaleF) # add in the margin the defined labels and title
      mtext(y1lab,side=2,line=3,cex=ScaleF)
      mtext(WS,side=3,line=1.5,cex=ScaleF)
      
      legend("topleft",c("Flow"),lty = c(1), col = c("blue"))

```

# Exercise 2

Calculating the lowest, highest, mean, median, as well as the 10th and 90th percentile of the flow rates yields:


- The mean flow was `r signif(mean(Q),digits=3)` m^3^/s
- the 10^th^percentile of flow was `r signif(quantile(Q,0.1),digits=3)` m^3^/s
- The mean flow rate was ___ m^3^/s.
- The median flow rate was `r signif(median(Q),digits=3)` m^3^/s.
- The 10^th^ percentile of flow rate was ___  m^3^/s.
- The 90^th^ percentile of flow rate was ___  m^3^/s.


# Exercise 3

Calculating and comparing the arithmetic average and medium concentrations for nitrate, TP, SRP, and TSS over the entire year of record. As of note, the reference values for agricultural watersheds are, respectively, 5 mg N/L, 0.3 mg P/L, 0.03 mg P/L, and 20 mg TSS/L. Compare your results to these reference values.


```{r , echo=FALSE, eval=TRUE}
NO3<-data$NO3
TP<-data$TP
SRP<-data$SRP
SRPini<-data$SRP
SRPcorr<-data$SRP
SRPcorr[SRPcorr<=0]=NA
mean(na.omit(SRPcorr))
```

- The mean concentration for nitrate was ___ mg N/L
- The median concentration for nitrate was ___ mg N/L.

And so on. Compare mean versus median and discuss the difference. And there almost the same, or not. If they were really different, think about what would is say about the occurrence of high values. Compare them to the reference values we have seen in class. Similarly discuss your findings for the other parameters.

# Exercise 4

Plot the hydrograph and nitrate, TP, SRP, and TSS chemographs for the Cuyahoga River at Independence, Ohio, over the first two weeks of March 2009. Using text, report whether the chemographs exhibit a concentration or a dilution effect.

# Exercise 5

Plot the flow duration curve over the entire period of record using the log/log scale graph.
Report the total flow volume that occurred in 2%, 5%, and 10% of the time, corresponding to the highest flow.


# Exercise 6

Plot the load duration curve over the entire period of record using the log/log scale graph.
Report the total load that occurred in 2%, 5%, and 10% of the time, corresponding to the highest loads.

Compare these values to the ones you obtained for flow, and discuss whether or not that makes sense.

